# Интеграция FreeTorr в ReYohoho

## Описание

Данная интеграция добавляет поддержку автоматического переключения торрент-серверов через систему FreeTorr в приложение ReYohoho.

## Что добавлено

### 1. FreeTorrManager
- **Файл**: `app/src/main/java/com/example/reyohoho/ui/FreeTorrManager.kt`
- **Функции**:
  - Получение случайного торрент-сервера от основного сервера `185.87.48.42:8090`
  - Автоматическое переключение при ошибках
  - Проверка доступности серверов
  - Генерация JavaScript кода для интеграции

### 2. Обновленные настройки
- **Файл**: `app/src/main/java/com/example/reyohoho/ui/SettingsManager.kt`
- **Новые настройки**:
  - `TORR_SERVER_MODE_CUSTOM` - пользовательский сервер
  - `TORR_SERVER_MODE_FREE_TORR` - автоматический FreeTorr
  - `freeTorrEnabled` - включение/выключение FreeTorr
  - `autoSwitchServers` - автоматическое переключение серверов

### 3. Обновленный TorrServeManager
- **Файл**: `app/src/main/java/com/example/reyohoho/ui/TorrServeManager.kt`
- **Новые функции**:
  - Интеграция с FreeTorrManager
  - Автоматическое переключение при ошибках
  - Инициализация FreeTorr сервера
  - Проверка доступности текущего сервера

### 4. JavaScript интеграция
- **Файл**: `app/src/main/java/com/example/reyohoho/WebViewComponent.kt`
- **Новые компоненты**:
  - `FreeTorrJSInterface` - JavaScript интерфейс для FreeTorr
  - `initializeFreeTorr()` - инициализация в WebView
  - Автоматическая загрузка JavaScript кода

### 5. Обновленный экран настроек
- **Файл**: `app/src/main/java/com/example/reyohoho/ui/SettingsScreen.kt`
- **Новые элементы**:
  - Переключатель режима сервера (Свой/FreeTorr)
  - Настройка автоматического переключения
  - Кнопка принудительного переключения сервера
  - Информация о FreeTorr

## Как работает система

### 1. Инициализация
При запуске приложения, если включен режим FreeTorr:
1. Приложение делает запрос к `http://185.87.48.42:8090/random_torr`
2. Получает случайный IP-адрес торрент-сервера
3. Формирует полный URL: `http://[IP]:8090`
4. Сохраняет URL в настройках

### 2. Автоматическое переключение
При ошибках подключения к текущему серверу:
1. Система автоматически запрашивает новый сервер
2. Обновляет URL в настройках
3. Продолжает работу с новым сервером

### 3. JavaScript интеграция
В WebView загружается JavaScript код, который:
1. Предоставляет функции для работы с FreeTorr
2. Уведомляет Android приложение об изменениях сервера
3. Позволяет управлять серверами из веб-интерфейса

## Сборка приложения

### 1. Подготовка
Убедитесь, что у вас установлены:
- Android Studio
- JDK 11 или выше
- Android SDK

### 2. Открытие проекта
1. Откройте Android Studio
2. Выберите "Open an existing project"
3. Укажите папку `App/`

### 3. Синхронизация
1. Дождитесь завершения синхронизации Gradle
2. Убедитесь, что все зависимости загружены

### 4. Сборка
1. Выберите Build → Build Bundle(s) / APK(s) → Build APK(s)
2. Дождитесь завершения сборки
3. APK файл будет создан в `app/build/outputs/apk/debug/`

### 5. Установка
1. Скопируйте APK на устройство
2. Установите приложение
3. Разрешите установку из неизвестных источников

## Использование

### 1. Включение FreeTorr
1. Откройте приложение
2. Перейдите в настройки
3. Включите "Активировать торренты"
4. Выберите режим "FreeTorr"
5. Включите "Автоматическое переключение серверов"

### 2. Проверка работы
1. Откройте любой фильм на сайте
2. Нажмите кнопку "Смотреть" рядом с торрентом
3. Система автоматически подключится к FreeTorr серверу
4. При проблемах сервер автоматически переключится

### 3. Ручное переключение
1. В настройках нажмите "Переключить на другой сервер"
2. Система получит новый сервер от FreeTorr
3. Уведомление покажет результат операции

## Технические детали

### Основной сервер FreeTorr
- **IP**: `185.87.48.42`
- **Порт**: `8090`
- **Эндпоинт**: `/random_torr`
- **Протокол**: HTTP GET

### Получаемые серверы
- Формат ответа: IP-адрес в текстовом виде
- Порт: автоматически добавляется `:8090`
- Пример: `185.87.48.42` → `http://185.87.48.42:8090`

### Обработка ошибок
- Автоматическое переключение при ошибках сети
- Логирование всех операций
- Уведомления пользователя о статусе

## Безопасность

- Все запросы выполняются через HTTPS где возможно
- Проверка доступности серверов перед использованием
- Ограничение времени ожидания запросов
- Логирование для диагностики проблем

## Поддержка

При возникновении проблем:
1. Проверьте логи в Android Studio
2. Убедитесь в наличии интернет-соединения
3. Попробуйте переключить сервер вручную
4. Проверьте настройки брандмауэра

## Лицензия

Данная интеграция использует систему FreeTorr, которая предоставляет бесплатные торрент-серверы для пользователей.

